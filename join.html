<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log In - Bouquet Bysindi</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%); height: 100vh; display: flex; justify-content: center; align-items: center; }
        .auth-card { background: white; padding: 40px; width: 100%; max-width: 400px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); text-align: center; }
        .logo { font-family: 'Playfair Display', serif; font-size: 24px; font-weight: 600; color: #333; margin-bottom: 30px; display: inline-block; }
        .logo i { color: #D61C4E; }
        h2 { font-family: 'Playfair Display', serif; color: #222; margin-bottom: 10px; }
        p.subtitle { color: #666; font-size: 14px; margin-bottom: 30px; }
        .input-group { text-align: left; margin-bottom: 20px; }
        .input-group label { display: block; font-size: 13px; font-weight: 500; color: #555; margin-bottom: 8px; }
        .input-group input { width: 100%; padding: 12px 15px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Poppins', sans-serif; transition: border 0.3s; }
        .input-group input:focus { outline: none; border-color: #D61C4E; }
        .btn-submit { width: 100%; padding: 12px; background-color: #D61C4E; color: white; border: none; border-radius: 50px; font-weight: 600; cursor: pointer; transition: background 0.3s; margin-top: 10px; }
        .btn-submit:hover { background-color: #b0163f; }
        .links { margin-top: 20px; font-size: 13px; }
        .links a { color: #D61C4E; text-decoration: none; font-weight: 500; }
        .error-message { background-color: #ffe6e6; color: #d61c4e; padding: 10px; border-radius: 5px; font-size: 12px; margin-bottom: 20px; display: none; border: 1px solid #ffb3b3; }
    </style>
</head>
<body>

    <div class="auth-card">
        <a href="index.html" style="text-decoration: none;">
            <div class="logo"><i class="fa-solid fa-heart"></i> Bouquet Bysindi</div>
        </a>
        
        <h2>Welcome Back!</h2>
        <p class="subtitle">Login to manage & track your orders</p>

        <div id="errorAlert" class="error-message"></div>

        <form id="loginForm">
            <div class="input-group">
                <label>Email Address</label>
                <input type="email" id="loginEmail" placeholder="example@mail.com" required>
            </div>
            
            <div class="input-group">
                <label>Password</label>
                <input type="password" id="loginPassword" placeholder="••••••••" required>
            </div>

            <button type="submit" class="btn-submit">Log in</button>
        </form>

        <div class="links">
            <p>Don't have an account? <a href="signin.html">Sign Up</a></p> 
            <br>
            <a href="#">Forgot Password?</a>
        </div>
        
        <a href="index.html" style="font-size: 12px; color: #999; text-decoration: none; display:block; margin-top:30px;">← Back to Home</a>
    </div>

   <script type="module">
    // 1. Import Library Firebase (Wajib)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyAOcC8fQxV-hkY-flVrLnBNyw6tWb-zfB0",
      authDomain: "bouquet-6e6a5.firebaseapp.com",
      projectId: "bouquet-6e6a5",
      storageBucket: "bouquet-6e6a5.firebasestorage.app",
      messagingSenderId: "423899480742",
      appId: "1:423899480742:web:795f89c9c752b5da7a2a67",
      measurementId: "G-R081Z7B7MG"
    };

    // 3. Mulai Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // 4. Logika Login (Saat Tombol Sign In Ditekan)
    document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault(); // Mencegah reload halaman
        
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        const btnLogin = document.querySelector('.btn-submit');
        const errorAlert = document.getElementById('errorAlert');

        // Ubah tombol jadi Loading
        btnLogin.innerText = "Checking...";
        btnLogin.disabled = true;

        // Cek ke Google Firebase
        signInWithEmailAndPassword(auth, email, password)
            .then((userCredential) => {
                // --- BERHASIL LOGIN ---
                const user = userCredential.user;
                const namaUser = user.displayName || "Pelanggan"; // Ambil nama dari server

                // Simpan status login agar halaman home tahu
                sessionStorage.setItem('isLoggedIn', 'true');
                sessionStorage.setItem('userName', namaUser);

                alert("Login Berhasil! Selamat datang, " + namaUser);
                window.location.href = "index.html"; // Pindah ke Home
            })
            .catch((error) => {
                // --- GAGAL LOGIN ---
                btnLogin.innerText = "Sign In";
                btnLogin.disabled = false;
                
                errorAlert.style.display = 'block';
                
                // Pesan Error yang lebih ramah
                if (error.code === 'auth/invalid-credential' || error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorAlert.innerHTML = '<i class="fa-solid fa-circle-exclamation"></i> Email atau Password salah!';
                } else if (error.code === 'auth/too-many-requests') {
                    errorAlert.innerHTML = '<i class="fa-solid fa-circle-exclamation"></i> Terlalu banyak mencoba. Tunggu sebentar.';
                } else {
                    errorAlert.innerHTML = '<i class="fa-solid fa-circle-exclamation"></i> Error: ' + error.message;
                }
            });
    });
</script>

</body>

</html>

